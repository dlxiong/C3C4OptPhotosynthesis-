install.packages("devtools")
install.packages("roxygen2")
library(devtools)
load_all()
load_all()
install.packages("rootSolve")
library(C3C4OptPhotosynthesis)
library(rootSolve)
StartV<-c(4.45,6,0.856)
C3RuBPCarboxy(69,200,5,-0.5,1,1400,StartV)
library(C3C4OptPhotosynthesis)
library(rootSolve)
StartV
library(C3C4OptPhotosynthesis)
ss<-C3RuBPCarboxy(69,200,5,-0.5,1,1400,StartV)
library(C3C4OptPhotosynthesis)
ss<-C3RuBPCarboxy(69,200,5,-0.5,1,1400,StartV)
ss$root
library(C3C4OptPhotosynthesis)
ss<-C3RuBPCarboxy(69,200,5,-0.5,1,1400,StartV)
ss$root
ss<-C3RuBPCarboxy(69,200,5,-0.5,1,1400,StartV)
ss$root
StartV
StartV<-c(4,6,0.8)
ss<-C3RuBPCarboxy(69,200,5,-0.5,1,1400,StartV)
ss$root
StartV<-c(4.4583,6.00091,0.855043)
ss<-C3RuBPCarboxy(69,200,5,-0.5,1,1400,StartV)
ss$root
library(C3C4OptPhotosynthesis)
ss<-C3RuBPCarboxy(69,200,5,-0.5,1,1400,StartV)
ss$root
library(C3C4OptPhotosynthesis)
ss<-C3RuBPCarboxy(69,200,5,-0.5,1,1400,StartV)
ss$root
StartV
StartV<-c(4.45,6,0.856)
ss<-C3RuBPCarboxy(69,200,5,-0.5,1,1400,StartV)
ss$root
library(C3C4OptPhotosynthesis)
ss<-C3RuBPCarboxy(69,200,5,-0.5,1,1400,StartV)
ss$root
x<-c(1,1,1)
x<-0
x[1]
x[2]
StartV<-c(4,7,0.88)
ss<-C3RuBPCarboxy(69,200,5,-0.5,1,1400,StartV)
ss$root
library(C3C4OptPhotosynthesis)
StartV<-c(7,8,0.9)
library(C3C4OptPhotosynthesis)
ss<-C3RuBPRegen(149,200,5,-1,2,1400,StartV)
ss$root
StartV<-c(17,1,0.93)
ss<-C4RuBPCarboxyPEPCarboxy(83,200,5,0,0.15,1400,StartV)
ss$root
StartV<-c(12.263,5,0.97)
ss<-C4RuBPCarboxyPEPCarboxy(83,200,5,0,0.15,1400,StartV)
ss$root
StartV<-c(8,20,0.95)
ss<-C4RuBPCarboxyPEPCarboxy(69,200,5,-0.5,1,1400,StartV)
ss$root
StartV<-c(6,20,0.9)
ss<-C4RuBPRegenPEPCarboxy(69,200,5,-1,2,1400,StartV)
ss$root
StartV<-c(5,17.6,0.87)
ss<-C4RuBPRegenPEPCarboxy(69,200,5,-1,2,1400,StartV)
ss$root
library(C3C4OptPhotosynthesis)
StartV<-c(6.4,17.59,0.875)
ss<-C4RuBPRegenPEPCarboxy(69,200,5,-1,2,1400,StartV)
ss$root
StartV<-c(5,10,0.8)
ss<-C4RuBPCarboxyPEPRegen(69,120,200,5,-0.5,1,1400,StartV)
ss$root
StartV<-c(5,50,0.9)
ss<-C4RuBPRegenPEPRegen(69,120,200,5,-1,2,1400,StartV)
ss$root
StartV<-c(5,50,0.8)
ss<-C4RuBPRegenPEPRegen(69,120,200,5,-1,2,1400,StartV)
StartV<-c(5,40,0.8)
ss<-C4RuBPRegenPEPRegen(69,120,200,5,-1,2,1400,StartV)
StartV<-c(5,45,0.85)
ss<-C4RuBPRegenPEPRegen(69,120,200,5,-1,2,1400,StartV)
StartV<-c(5,50,0.9)
ss<-C4RuBPRegenPEPRegen(69,120,200,5,-1,2,1400,StartV)
ss$root
StartV<-c(5.5,20,0.9)
ss<-C4RuBPCarboxyPEPRegen(69,120,200,5,-0.5,1,1400,StartV)
ss$root
StartV<-c(5.5,23.928,0.0.9445)
StartV<-c(5.5,23.928,0.9445)
ss<-C4RuBPCarboxyPEPRegen(69,120,200,5,-0.5,1,1400,StartV)
ss$root
ss
J<-exp(22.74-43.9/0.008314/(273+25))/(1 + exp((0.65*(273+25)-200)/0.008314/(273+25)))
J
library(C3C4OptPhotosynthesis)
StartV<-c(4,7,0.88)
ss<-C3RuBPCarboxy(69,140.5178,200,5,-0.5,1,StartV)
ss$root
StartV<-c(7,8,0.9)
ss<-C3RuBPRegen(69,140.5178,200,5,-1,2,StartV)
ss$root
StartV<-c(8,20,0.95)
ss<-C4RuBPCarboxyPEPCarboxy(69,140.5178,200,5,-0.5,1,StartV)
ss$root
StartV<-c(6,18,0.875)
ss<-C4RuBPRegenPEPCarboxy(69,140.5178,200,5,-1,2,StartV)
StartV<-c(6,20,0.8875)
ss<-C4RuBPRegenPEPCarboxy(69,140.5178,200,5,-1,2,StartV)
ss$root
StartV<-c(6,20,0.88)
ss<-C4RuBPRegenPEPCarboxy(69,140.5178,200,5,-1,2,StartV)
ss$root
StartV<-c(5,10,0.8)
ss<-C4RuBPCarboxyPEPRegen(69,140.5178,200,5,-1,2,StartV)
ss$root
ss<-C4RuBPCarboxyPEPRegen(69,140.5178,200,5,-0.5,1,StartV)
ss$root
StartV<-c(5,20,0.9)
ss<-C4RuBPCarboxyPEPRegen(69,140.5178,200,5,-0.5,1,StartV)
ss$root
StartV<-c(5,23,0.94)
ss<-C4RuBPCarboxyPEPRegen(69,140.5178,200,5,-0.5,1,StartV)
ss$root
StartV<-c(5,23,0.92)
ss<-C4RuBPCarboxyPEPRegen(69,140.5178,200,5,-0.5,1,StartV)
ss$root
StartV<-c(5,50,0.9)
ss<-C4RuBPRegenPEPRegen(69,140.5178,200,5,-0.5,1,StartV)
ss<-C4RuBPRegenPEPRegen(69,140.5178,200,5,-1,2,StartV)
ss$root
library(C3C4OptPhotosynthesis)
library(C3C4OptPhotosynthesis)
lon<-{-90., -88.1053, -86.2105, -84.3158, -82.4211, -80.5263, -78.6316, \
-76.7368, -74.8421, -72.9474, -71.0526, -69.1579, -67.2632, -65.3684, \
-63.4737, -61.5789, -59.6842, -57.7895, -55.8947, -54., -52.1053, \
-50.2105, -48.3158, -46.4211, -44.5263, -42.6316, -40.7368, -38.8421, \
-36.9474, -35.0526, -33.1579, -31.2632, -29.3684, -27.4737, -25.5789, \
-23.6842, -21.7895, -19.8947, -18., -16.1053, -14.2105, -12.3158, \
-10.4211, -8.52632, -6.63158, -4.73684, -2.84211, -0.947368, \
0.947368, 2.84211, 4.73684, 6.63158, 8.52632, 10.4211, 12.3158, \
14.2105, 16.1053, 18., 19.8947, 21.7895, 23.6842, 25.5789, 27.4737, \
29.3684, 31.2632, 33.1579, 35.0526, 36.9474, 38.8421, 40.7368, \
42.6316, 44.5263, 46.4211, 48.3158, 50.2105, 52.1053, 54., 55.8947, \
57.7895, 59.6842, 61.5789, 63.4737, 65.3684, 67.2632, 69.1579, \
71.0526, 72.9474, 74.8421, 76.7368, 78.6316, 80.5263, 82.4211, \
84.3158, 86.2105, 88.1053, 90.}
lon<-c(-90., -88.1053, -86.2105, -84.3158, -82.4211, -80.5263, -78.6316, \
-76.7368, -74.8421, -72.9474, -71.0526, -69.1579, -67.2632, -65.3684, \
-63.4737, -61.5789, -59.6842, -57.7895, -55.8947, -54., -52.1053, \
-50.2105, -48.3158, -46.4211, -44.5263, -42.6316, -40.7368, -38.8421, \
-36.9474, -35.0526, -33.1579, -31.2632, -29.3684, -27.4737, -25.5789, \
-23.6842, -21.7895, -19.8947, -18., -16.1053, -14.2105, -12.3158, \
-10.4211, -8.52632, -6.63158, -4.73684, -2.84211, -0.947368, \
0.947368, 2.84211, 4.73684, 6.63158, 8.52632, 10.4211, 12.3158, \
14.2105, 16.1053, 18., 19.8947, 21.7895, 23.6842, 25.5789, 27.4737, \
29.3684, 31.2632, 33.1579, 35.0526, 36.9474, 38.8421, 40.7368, \
42.6316, 44.5263, 46.4211, 48.3158, 50.2105, 52.1053, 54., 55.8947, \
57.7895, 59.6842, 61.5789, 63.4737, 65.3684, 67.2632, 69.1579, \
71.0526, 72.9474, 74.8421, 76.7368, 78.6316, 80.5263, 82.4211, 84.3158, 86.2105, 88.1053, 90.)
lon<-c(-90., -88.1053, -86.2105, -84.3158, -82.4211, -80.5263, -78.6316, -76.7368, -74.8421, -72.9474, -71.0526, -69.1579, -67.2632, -65.3684, -63.4737, -61.5789, -59.6842, -57.7895, -55.8947, -54., -52.1053, -50.2105, -48.3158, -46.4211, -44.5263, -42.6316, -40.7368, -38.8421, -36.9474, -35.0526, -33.1579, -31.2632, -29.3684, -27.4737, -25.5789, -23.6842, -21.7895, -19.8947, -18., -16.1053, -14.2105, -12.3158, -10.4211, -8.52632, -6.63158, -4.73684, -2.84211, -0.947368, 0.947368, 2.84211, 4.73684, 6.63158, 8.52632, 10.4211, 12.3158, 14.2105, 16.1053, 18., 19.8947, 21.7895, 23.6842, 25.5789, 27.4737, 29.3684, 31.2632, 33.1579, 35.0526, 36.9474, 38.8421, 40.7368, 42.6316, 44.5263, 46.4211, 48.3158, 50.2105, 52.1053, 54., 55.8947, 57.7895, 59.6842, 61.5789, 63.4737, 65.3684, 67.2632, 69.1579, 71.0526, 72.9474, 74.8421, 76.7368, 78.6316, 80.5263, 82.4211, 84.3158, 86.2105, 88.1053, 90.)
lat<-c(-90., -88.1053, -86.2105, -84.3158, -82.4211, -80.5263, -78.6316, -76.7368, -74.8421, -72.9474, -71.0526, -69.1579, -67.2632, -65.3684, -63.4737, -61.5789, -59.6842, -57.7895, -55.8947, -54., -52.1053, -50.2105, -48.3158, -46.4211, -44.5263, -42.6316, -40.7368, -38.8421, -36.9474, -35.0526, -33.1579, -31.2632, -29.3684, -27.4737, -25.5789, -23.6842, -21.7895, -19.8947, -18., -16.1053, -14.2105, -12.3158, -10.4211, -8.52632, -6.63158, -4.73684, -2.84211, -0.947368, 0.947368, 2.84211, 4.73684, 6.63158, 8.52632, 10.4211, 12.3158, 14.2105, 16.1053, 18., 19.8947, 21.7895, 23.6842, 25.5789, 27.4737, 29.3684, 31.2632, 33.1579, 35.0526, 36.9474, 38.8421, 40.7368, 42.6316, 44.5263, 46.4211, 48.3158, 50.2105, 52.1053, 54., 55.8947, 57.7895, 59.6842, 61.5789, 63.4737, 65.3684, 67.2632, 69.1579, 71.0526, 72.9474, 74.8421, 76.7368, 78.6316, 80.5263, 82.4211, 84.3158, 86.2105, 88.1053, 90.)
lon<-c(0., 2.5, 5., 7.5, 10., 12.5, 15., 17.5, 20., 22.5, 25., 27.5, 30.,
32.5, 35., 37.5, 40., 42.5, 45., 47.5, 50., 52.5, 55., 57.5, 60.,
62.5, 65., 67.5, 70., 72.5, 75., 77.5, 80., 82.5, 85., 87.5, 90.,
92.5, 95., 97.5, 100., 102.5, 105., 107.5, 110., 112.5, 115., 117.5,
120., 122.5, 125., 127.5, 130., 132.5, 135., 137.5, 140., 142.5,
145., 147.5, 150., 152.5, 155., 157.5, 160., 162.5, 165., 167.5,
170., 172.5, 175., 177.5, 180., 182.5, 185., 187.5, 190., 192.5,
195., 197.5, 200., 202.5, 205., 207.5, 210., 212.5, 215., 217.5,
220., 222.5, 225., 227.5, 230., 232.5, 235., 237.5, 240., 242.5,
245., 247.5, 250., 252.5, 255., 257.5, 260., 262.5, 265., 267.5,
270., 272.5, 275., 277.5, 280., 282.5, 285., 287.5, 290., 292.5,
295., 297.5, 300., 302.5, 305., 307.5, 310., 312.5, 315., 317.5,
320., 322.5, 325., 327.5, 330., 332.5, 335., 337.5, 340., 342.5,
345., 347.5, 350., 352.5, 355., 357.5)
nlong<-144
nlat<-96
fillvalue <- 1e32
A270JV21_array <- array(fillvalue, dim=c(nlong,nlat))
setwd("~/Desktop/C3 and C4 modeling data")
MyData<-read.csv(file="A270JV21.csv", header=TRUE,sep=",")
A<-c(1,1,1,2,2,2,3,3,3)
Arr<-array(A,dim=c(3,3))
Arr
str(MyData)
ptm <- proc.time()
nobs<-dim(MyData$Assimilation.difference..C4.C3.)
nobs
nobs<-dim(MyData)[1]
nobs
MyData$Assimilation.difference..C4.C3.[1]
for(i in 1:nobs) {
)
lat3<-as.array(c(-90., -88.1053, -86.2105, -84.3158, -82.4211, -80.5263, -78.6316, -76.7368, -74.8421, -72.9474, -71.0526, -69.1579, -67.2632, -65.3684, -63.4737, -61.5789, -59.6842, -57.7895, -55.8947, -54., -52.1053, -50.2105, -48.3158, -46.4211, -44.5263, -42.6316, -40.7368, -38.8421, -36.9474, -35.0526, -33.1579, -31.2632, -29.3684, -27.4737, -25.5789, -23.6842, -21.7895, -19.8947, -18., -16.1053, -14.2105, -12.3158, -10.4211, -8.52632, -6.63158, -4.73684, -2.84211, -0.947368, 0.947368, 2.84211, 4.73684, 6.63158, 8.52632, 10.4211, 12.3158, 14.2105, 16.1053, 18., 19.8947, 21.7895, 23.6842, 25.5789, 27.4737, 29.3684, 31.2632, 33.1579, 35.0526, 36.9474, 38.8421, 40.7368, 42.6316, 44.5263, 46.4211, 48.3158, 50.2105, 52.1053, 54., 55.8947, 57.7895, 59.6842, 61.5789, 63.4737, 65.3684, 67.2632, 69.1579, 71.0526, 72.9474, 74.8421, 76.7368, 78.6316, 80.5263, 82.4211, 84.3158, 86.2105, 88.1053, 90.))
lon3<-as.array(c(0., 2.5, 5., 7.5, 10., 12.5, 15., 17.5, 20., 22.5, 25., 27.5, 30.,
+     32.5, 35., 37.5, 40., 42.5, 45., 47.5, 50., 52.5, 55., 57.5, 60.,
+     62.5, 65., 67.5, 70., 72.5, 75., 77.5, 80., 82.5, 85., 87.5, 90.,
+     92.5, 95., 97.5, 100., 102.5, 105., 107.5, 110., 112.5, 115., 117.5,
+     120., 122.5, 125., 127.5, 130., 132.5, 135., 137.5, 140., 142.5,
+     145., 147.5, 150., 152.5, 155., 157.5, 160., 162.5, 165., 167.5,
+     170., 172.5, 175., 177.5, 180., 182.5, 185., 187.5, 190., 192.5,
+     195., 197.5, 200., 202.5, 205., 207.5, 210., 212.5, 215., 217.5,
+     220., 222.5, 225., 227.5, 230., 232.5, 235., 237.5, 240., 242.5,
+     245., 247.5, 250., 252.5, 255., 257.5, 260., 262.5, 265., 267.5,
+     270., 272.5, 275., 277.5, 280., 282.5, 285., 287.5, 290., 292.5,
+     295., 297.5, 300., 302.5, 305., 307.5, 310., 312.5, 315., 317.5,
+     320., 322.5, 325., 327.5, 330., 332.5, 335., 337.5, 340., 342.5,
+     345., 347.5, 350., 352.5, 355., 357.5))
for(i in 1:nobs) {
j <- which.min(abs(lon3-MyData$coordinate.longitude..degrees_east.[i]))
k <- which.min(abs(lat3-MyData$coordinate.latitude..degrees_north.[i]))
Assidiffarray3[j,k]<-MyData$Assimilation.difference..C4.C3.[i]
}
Assidiffarray3<-array(fillvalue,dim=c(nlong,nlat))
for(i in 1:nobs) {j <- which.min(abs(lon3-MyData$coordinate.longitude..degrees_east.[i]))
+ k <- which.min(abs(lat3-MyData$coordinate.latitude..degrees_north.[i]))
+
+ Assidiffarray3[j,k]<-MyData$Assimilation.difference..C4.C3.[i]
+ }
for(i in 1:nobs) {
j <- which.min(abs(lon3-MyData$coordinate.longitude..degrees_east.[i]))
k <- which.min(abs(lat3-MyData$coordinate.latitude..degrees_north.[i]))
Assidiffarray3[j,k]<-MyData$Assimilation.difference..C4.C3.[i]
}
Assidiffarray3
library(ncdf4)
install.packages("ncdf4")
library(ncdf4)
londim <- ncdim_def("lon","degrees_east",as.double(lon3))
latdim <- ncdim_def("lat","degrees_north",as.double(lat3))
fillvalue <- 1e32
dlname <- "AssiDiff270JV21"
Assi_def <- ncvar_def("AssiD","micro mol per m2 per s",list(londim,latdim),fillvalue,dlname,prec="single")
ncfname<-"A270JV21.nc"
cout <- nc_create(ncfname,list(Assi_def),force_v4=T)
ncout <- nc_create(ncfname,list(Assi_def),force_v4=T)
ncvar_put(cout,Assi_def,Assidiffarray3)
ncatt_put(cout,"lon","axis","X")
ncatt_put(ncout,"lat","axis","Y")
ncatt_put(cout,"lat","axis","Y")
nc_close(cout)
setwd("~/Desktop/C3 and C4 modeling data")
MyData<-read.csv(file="A270JV45.csv", header=TRUE,sep=",")
nobs<-dim(MyData)[1]
nlong<-144
nlat<-96
lat3<-as.array(c(-90., -88.1053, -86.2105, -84.3158, -82.4211, -80.5263, -78.6316, -76.7368, -74.8421, -72.9474, -71.0526, -69.1579, -67.2632, -65.3684, -63.4737, -61.5789, -59.6842, -57.7895, -55.8947, -54., -52.1053, -50.2105, -48.3158, -46.4211, -44.5263, -42.6316, -40.7368, -38.8421, -36.9474, -35.0526, -33.1579, -31.2632, -29.3684, -27.4737, -25.5789, -23.6842, -21.7895, -19.8947, -18., -16.1053, -14.2105, -12.3158, -10.4211, -8.52632, -6.63158, -4.73684, -2.84211, -0.947368, 0.947368, 2.84211, 4.73684, 6.63158, 8.52632, 10.4211, 12.3158, 14.2105, 16.1053, 18., 19.8947, 21.7895, 23.6842, 25.5789, 27.4737, 29.3684, 31.2632, 33.1579, 35.0526, 36.9474, 38.8421, 40.7368, 42.6316, 44.5263, 46.4211, 48.3158, 50.2105, 52.1053, 54., 55.8947, 57.7895, 59.6842, 61.5789, 63.4737, 65.3684, 67.2632, 69.1579, 71.0526, 72.9474, 74.8421, 76.7368, 78.6316, 80.5263, 82.4211, 84.3158, 86.2105, 88.1053, 90.))
lon3<-as.array(c(0., 2.5, 5., 7.5, 10., 12.5, 15., 17.5, 20., 22.5, 25., 27.5, 30., 32.5, 35., 37.5, 40., 42.5, 45., 47.5, 50., 52.5, 55., 57.5, 60., 62.5, 65., 67.5, 70., 72.5, 75., 77.5, 80., 82.5, 85., 87.5, 90., 92.5, 95., 97.5, 100., 102.5, 105., 107.5, 110., 112.5, 115., 117.5, 120., 122.5, 125., 127.5, 130., 132.5, 135., 137.5, 140., 142.5, 145., 147.5, 150., 152.5, 155., 157.5, 160., 162.5, 165., 167.5, 170., 172.5, 175., 177.5, 180., 182.5, 185., 187.5, 190., 192.5, 195., 197.5, 200., 202.5, 205., 207.5, 210., 212.5, 215., 217.5, 220., 222.5, 225., 227.5, 230., 232.5, 235., 237.5, 240., 242.5, 245., 247.5, 250., 252.5, 255., 257.5, 260., 262.5, 265., 267.5, 270., 272.5, 275., 277.5, 280., 282.5, 285., 287.5, 290., 292.5, 295., 297.5, 300., 302.5, 305., 307.5, 310., 312.5, 315., 317.5, 320., 322.5, 325., 327.5, 330., 332.5, 335., 337.5, 340., 342.5, 345., 347.5, 350., 352.5, 355., 357.5))
Assidiffarray3<-array(fillvalue,dim=c(nlong,nlat))
fillvalue <- 1e32
Assidiffarray3<-array(fillvalue,dim=c(nlong,nlat))
for(i in 1:nobs) {
j <- which.min(abs(lon3-MyData$coordinate.longitude..degrees_east.[i]))
k <- which.min(abs(lat3-MyData$coordinate.latitude..degrees_north.[i]))
Assidiffarray3[j,k]<-MyData$Assimilation.difference..C4.C3.[i]
}
library(ncdf4)
londim <- ncdim_def("lon","degrees_east",as.double(lon3))
latdim <- ncdim_def("lat","degrees_north",as.double(lat3))
dlname <- "AssiDiff270JV45"
Assi_def <- ncvar_def("AssiD","micro mol per m2 per s",list(londim,latdim),fillvalue,dlname,prec="single")
ncfname<-"A270JV45.nc"
cout <- nc_create(ncfname,list(Assi_def),force_v4=T)
ncvar_put(cout,Assi_def,Assidiffarray3)
ncatt_put(cout,"lon","axis","X")
ncatt_put(cout,"lat","axis","Y")
nc_close(cout)
setwd("~/Desktop/C3 and C4 modeling data")
MyData<-read.csv(file="A400JV21.csv", header=TRUE,sep=",")
nobs<-dim(MyData)[1]
nlong<-144
nlat<-96
fillvalue <- 1e32
lat3<-as.array(c(-90., -88.1053, -86.2105, -84.3158, -82.4211, -80.5263, -78.6316, -76.7368, -74.8421, -72.9474, -71.0526, -69.1579, -67.2632, -65.3684, -63.4737, -61.5789, -59.6842, -57.7895, -55.8947, -54., -52.1053, -50.2105, -48.3158, -46.4211, -44.5263, -42.6316, -40.7368, -38.8421, -36.9474, -35.0526, -33.1579, -31.2632, -29.3684, -27.4737, -25.5789, -23.6842, -21.7895, -19.8947, -18., -16.1053, -14.2105, -12.3158, -10.4211, -8.52632, -6.63158, -4.73684, -2.84211, -0.947368, 0.947368, 2.84211, 4.73684, 6.63158, 8.52632, 10.4211, 12.3158, 14.2105, 16.1053, 18., 19.8947, 21.7895, 23.6842, 25.5789, 27.4737, 29.3684, 31.2632, 33.1579, 35.0526, 36.9474, 38.8421, 40.7368, 42.6316, 44.5263, 46.4211, 48.3158, 50.2105, 52.1053, 54., 55.8947, 57.7895, 59.6842, 61.5789, 63.4737, 65.3684, 67.2632, 69.1579, 71.0526, 72.9474, 74.8421, 76.7368, 78.6316, 80.5263, 82.4211, 84.3158, 86.2105, 88.1053, 90.))
lon3<-as.array(c(0., 2.5, 5., 7.5, 10., 12.5, 15., 17.5, 20., 22.5, 25., 27.5, 30., 32.5, 35., 37.5, 40., 42.5, 45., 47.5, 50., 52.5, 55., 57.5, 60., 62.5, 65., 67.5, 70., 72.5, 75., 77.5, 80., 82.5, 85., 87.5, 90., 92.5, 95., 97.5, 100., 102.5, 105., 107.5, 110., 112.5, 115., 117.5, 120., 122.5, 125., 127.5, 130., 132.5, 135., 137.5, 140., 142.5, 145., 147.5, 150., 152.5, 155., 157.5, 160., 162.5, 165., 167.5, 170., 172.5, 175., 177.5, 180., 182.5, 185., 187.5, 190., 192.5, 195., 197.5, 200., 202.5, 205., 207.5, 210., 212.5, 215., 217.5, 220., 222.5, 225., 227.5, 230., 232.5, 235., 237.5, 240., 242.5, 245., 247.5, 250., 252.5, 255., 257.5, 260., 262.5, 265., 267.5, 270., 272.5, 275., 277.5, 280., 282.5, 285., 287.5, 290., 292.5, 295., 297.5, 300., 302.5, 305., 307.5, 310., 312.5, 315., 317.5, 320., 322.5, 325., 327.5, 330., 332.5, 335., 337.5, 340., 342.5, 345., 347.5, 350., 352.5, 355., 357.5))
Assidiffarray3<-array(fillvalue,dim=c(nlong,nlat))
for(i in 1:nobs) {
j <- which.min(abs(lon3-MyData$coordinate.longitude..degrees_east.[i]))
k <- which.min(abs(lat3-MyData$coordinate.latitude..degrees_north.[i]))
Assidiffarray3[j,k]<-MyData$Assimilation.difference..C4.C3.[i]
}
library(ncdf4)
londim <- ncdim_def("lon","degrees_east",as.double(lon3))
latdim <- ncdim_def("lat","degrees_north",as.double(lat3))
dlname <- "AssiDiff400JV21"
Assi_def <- ncvar_def("AssiD","micro mol per m2 per s",list(londim,latdim),fillvalue,dlname,prec="single")
ncfname<-"A400JV21.nc"
cout <- nc_create(ncfname,list(Assi_def),force_v4=T)
ncvar_put(cout,Assi_def,Assidiffarray3)
ncatt_put(cout,"lon","axis","X")
ncatt_put(cout,"lat","axis","Y")
nc_close(cout)
setwd("~/Desktop/C3 and C4 modeling data")
MyData<-read.csv(file="A400JV45.csv", header=TRUE,sep=",")
nobs<-dim(MyData)[1]
nlong<-144
nlat<-96
fillvalue <- 1e32
lat3<-as.array(c(-90., -88.1053, -86.2105, -84.3158, -82.4211, -80.5263, -78.6316, -76.7368, -74.8421, -72.9474, -71.0526, -69.1579, -67.2632, -65.3684, -63.4737, -61.5789, -59.6842, -57.7895, -55.8947, -54., -52.1053, -50.2105, -48.3158, -46.4211, -44.5263, -42.6316, -40.7368, -38.8421, -36.9474, -35.0526, -33.1579, -31.2632, -29.3684, -27.4737, -25.5789, -23.6842, -21.7895, -19.8947, -18., -16.1053, -14.2105, -12.3158, -10.4211, -8.52632, -6.63158, -4.73684, -2.84211, -0.947368, 0.947368, 2.84211, 4.73684, 6.63158, 8.52632, 10.4211, 12.3158, 14.2105, 16.1053, 18., 19.8947, 21.7895, 23.6842, 25.5789, 27.4737, 29.3684, 31.2632, 33.1579, 35.0526, 36.9474, 38.8421, 40.7368, 42.6316, 44.5263, 46.4211, 48.3158, 50.2105, 52.1053, 54., 55.8947, 57.7895, 59.6842, 61.5789, 63.4737, 65.3684, 67.2632, 69.1579, 71.0526, 72.9474, 74.8421, 76.7368, 78.6316, 80.5263, 82.4211, 84.3158, 86.2105, 88.1053, 90.))
lon3<-as.array(c(0., 2.5, 5., 7.5, 10., 12.5, 15., 17.5, 20., 22.5, 25., 27.5, 30., 32.5, 35., 37.5, 40., 42.5, 45., 47.5, 50., 52.5, 55., 57.5, 60., 62.5, 65., 67.5, 70., 72.5, 75., 77.5, 80., 82.5, 85., 87.5, 90., 92.5, 95., 97.5, 100., 102.5, 105., 107.5, 110., 112.5, 115., 117.5, 120., 122.5, 125., 127.5, 130., 132.5, 135., 137.5, 140., 142.5, 145., 147.5, 150., 152.5, 155., 157.5, 160., 162.5, 165., 167.5, 170., 172.5, 175., 177.5, 180., 182.5, 185., 187.5, 190., 192.5, 195., 197.5, 200., 202.5, 205., 207.5, 210., 212.5, 215., 217.5, 220., 222.5, 225., 227.5, 230., 232.5, 235., 237.5, 240., 242.5, 245., 247.5, 250., 252.5, 255., 257.5, 260., 262.5, 265., 267.5, 270., 272.5, 275., 277.5, 280., 282.5, 285., 287.5, 290., 292.5, 295., 297.5, 300., 302.5, 305., 307.5, 310., 312.5, 315., 317.5, 320., 322.5, 325., 327.5, 330., 332.5, 335., 337.5, 340., 342.5, 345., 347.5, 350., 352.5, 355., 357.5))
Assidiffarray3<-array(fillvalue,dim=c(nlong,nlat))
for(i in 1:nobs) {
j <- which.min(abs(lon3-MyData$coordinate.longitude..degrees_east.[i]))
k <- which.min(abs(lat3-MyData$coordinate.latitude..degrees_north.[i]))
Assidiffarray3[j,k]<-MyData$Assimilation.difference..C4.C3.[i]
}
library(ncdf4)
londim <- ncdim_def("lon","degrees_east",as.double(lon3))
latdim <- ncdim_def("lat","degrees_north",as.double(lat3))
dlname <- "AssiDiff270JV21"
Assi_def <- ncvar_def("AssiD","micro mol per m2 per s",list(londim,latdim),fillvalue,dlname,prec="single")
dlname <- "AssiDiff400JV45"
Assi_def <- ncvar_def("AssiD","micro mol per m2 per s",list(londim,latdim),fillvalue,dlname,prec="single")
ncfname<-"A400JV45.nc"
cout <- nc_create(ncfname,list(Assi_def),force_v4=T)
ncvar_put(cout,Assi_def,Assidiffarray3)
ncatt_put(cout,"lon","axis","X")
ncatt_put(cout,"lat","axis","Y")
nc_close(cout)
setwd("~/Desktop/C3 and C4 modeling data")
MyData<-read.csv(file="A600JV21.csv", header=TRUE,sep=",")
nobs<-dim(MyData)[1]
nlong<-144
nlat<-96
fillvalue <- 1e32
lat3<-as.array(c(-90., -88.1053, -86.2105, -84.3158, -82.4211, -80.5263, -78.6316, -76.7368, -74.8421, -72.9474, -71.0526, -69.1579, -67.2632, -65.3684, -63.4737, -61.5789, -59.6842, -57.7895, -55.8947, -54., -52.1053, -50.2105, -48.3158, -46.4211, -44.5263, -42.6316, -40.7368, -38.8421, -36.9474, -35.0526, -33.1579, -31.2632, -29.3684, -27.4737, -25.5789, -23.6842, -21.7895, -19.8947, -18., -16.1053, -14.2105, -12.3158, -10.4211, -8.52632, -6.63158, -4.73684, -2.84211, -0.947368, 0.947368, 2.84211, 4.73684, 6.63158, 8.52632, 10.4211, 12.3158, 14.2105, 16.1053, 18., 19.8947, 21.7895, 23.6842, 25.5789, 27.4737, 29.3684, 31.2632, 33.1579, 35.0526, 36.9474, 38.8421, 40.7368, 42.6316, 44.5263, 46.4211, 48.3158, 50.2105, 52.1053, 54., 55.8947, 57.7895, 59.6842, 61.5789, 63.4737, 65.3684, 67.2632, 69.1579, 71.0526, 72.9474, 74.8421, 76.7368, 78.6316, 80.5263, 82.4211, 84.3158, 86.2105, 88.1053, 90.))
lon3<-as.array(c(0., 2.5, 5., 7.5, 10., 12.5, 15., 17.5, 20., 22.5, 25., 27.5, 30., 32.5, 35., 37.5, 40., 42.5, 45., 47.5, 50., 52.5, 55., 57.5, 60., 62.5, 65., 67.5, 70., 72.5, 75., 77.5, 80., 82.5, 85., 87.5, 90., 92.5, 95., 97.5, 100., 102.5, 105., 107.5, 110., 112.5, 115., 117.5, 120., 122.5, 125., 127.5, 130., 132.5, 135., 137.5, 140., 142.5, 145., 147.5, 150., 152.5, 155., 157.5, 160., 162.5, 165., 167.5, 170., 172.5, 175., 177.5, 180., 182.5, 185., 187.5, 190., 192.5, 195., 197.5, 200., 202.5, 205., 207.5, 210., 212.5, 215., 217.5, 220., 222.5, 225., 227.5, 230., 232.5, 235., 237.5, 240., 242.5, 245., 247.5, 250., 252.5, 255., 257.5, 260., 262.5, 265., 267.5, 270., 272.5, 275., 277.5, 280., 282.5, 285., 287.5, 290., 292.5, 295., 297.5, 300., 302.5, 305., 307.5, 310., 312.5, 315., 317.5, 320., 322.5, 325., 327.5, 330., 332.5, 335., 337.5, 340., 342.5, 345., 347.5, 350., 352.5, 355., 357.5))
Assidiffarray3<-array(fillvalue,dim=c(nlong,nlat))
for(i in 1:nobs) {
j <- which.min(abs(lon3-MyData$coordinate.longitude..degrees_east.[i]))
k <- which.min(abs(lat3-MyData$coordinate.latitude..degrees_north.[i]))
Assidiffarray3[j,k]<-MyData$Assimilation.difference..C4.C3.[i]
}
library(ncdf4)
londim <- ncdim_def("lon","degrees_east",as.double(lon3))
latdim <- ncdim_def("lat","degrees_north",as.double(lat3))
dlname <- "AssiDiff600JV21"
Assi_def <- ncvar_def("AssiD","micro mol per m2 per s",list(londim,latdim),fillvalue,dlname,prec="single")
ncfname<-"A600JV21.nc"
cout <- nc_create(ncfname,list(Assi_def),force_v4=T)
ncvar_put(cout,Assi_def,Assidiffarray3)
ncatt_put(cout,"lon","axis","X")
ncatt_put(cout,"lat","axis","Y")
nc_close(cout)
setwd("~/Desktop/C3 and C4 modeling data")
MyData<-read.csv(file="A600JV45.csv", header=TRUE,sep=",")
nobs<-dim(MyData)[1]
nlong<-144
nlat<-96
fillvalue <- 1e32
lat3<-as.array(c(-90., -88.1053, -86.2105, -84.3158, -82.4211, -80.5263, -78.6316, -76.7368, -74.8421, -72.9474, -71.0526, -69.1579, -67.2632, -65.3684, -63.4737, -61.5789, -59.6842, -57.7895, -55.8947, -54., -52.1053, -50.2105, -48.3158, -46.4211, -44.5263, -42.6316, -40.7368, -38.8421, -36.9474, -35.0526, -33.1579, -31.2632, -29.3684, -27.4737, -25.5789, -23.6842, -21.7895, -19.8947, -18., -16.1053, -14.2105, -12.3158, -10.4211, -8.52632, -6.63158, -4.73684, -2.84211, -0.947368, 0.947368, 2.84211, 4.73684, 6.63158, 8.52632, 10.4211, 12.3158, 14.2105, 16.1053, 18., 19.8947, 21.7895, 23.6842, 25.5789, 27.4737, 29.3684, 31.2632, 33.1579, 35.0526, 36.9474, 38.8421, 40.7368, 42.6316, 44.5263, 46.4211, 48.3158, 50.2105, 52.1053, 54., 55.8947, 57.7895, 59.6842, 61.5789, 63.4737, 65.3684, 67.2632, 69.1579, 71.0526, 72.9474, 74.8421, 76.7368, 78.6316, 80.5263, 82.4211, 84.3158, 86.2105, 88.1053, 90.))
lon3<-as.array(c(0., 2.5, 5., 7.5, 10., 12.5, 15., 17.5, 20., 22.5, 25., 27.5, 30., 32.5, 35., 37.5, 40., 42.5, 45., 47.5, 50., 52.5, 55., 57.5, 60., 62.5, 65., 67.5, 70., 72.5, 75., 77.5, 80., 82.5, 85., 87.5, 90., 92.5, 95., 97.5, 100., 102.5, 105., 107.5, 110., 112.5, 115., 117.5, 120., 122.5, 125., 127.5, 130., 132.5, 135., 137.5, 140., 142.5, 145., 147.5, 150., 152.5, 155., 157.5, 160., 162.5, 165., 167.5, 170., 172.5, 175., 177.5, 180., 182.5, 185., 187.5, 190., 192.5, 195., 197.5, 200., 202.5, 205., 207.5, 210., 212.5, 215., 217.5, 220., 222.5, 225., 227.5, 230., 232.5, 235., 237.5, 240., 242.5, 245., 247.5, 250., 252.5, 255., 257.5, 260., 262.5, 265., 267.5, 270., 272.5, 275., 277.5, 280., 282.5, 285., 287.5, 290., 292.5, 295., 297.5, 300., 302.5, 305., 307.5, 310., 312.5, 315., 317.5, 320., 322.5, 325., 327.5, 330., 332.5, 335., 337.5, 340., 342.5, 345., 347.5, 350., 352.5, 355., 357.5))
Assidiffarray3<-array(fillvalue,dim=c(nlong,nlat))
for(i in 1:nobs) {
j <- which.min(abs(lon3-MyData$coordinate.longitude..degrees_east.[i]))
k <- which.min(abs(lat3-MyData$coordinate.latitude..degrees_north.[i]))
Assidiffarray3[j,k]<-MyData$Assimilation.difference..C4.C3.[i]
}
library(ncdf4)
londim <- ncdim_def("lon","degrees_east",as.double(lon3))
latdim <- ncdim_def("lat","degrees_north",as.double(lat3))
dlname <- "AssiDiff600JV45"
Assi_def <- ncvar_def("AssiD","micro mol per m2 per s",list(londim,latdim),fillvalue,dlname,prec="single")
ncfname<-"A600JV45.nc"
cout <- nc_create(ncfname,list(Assi_def),force_v4=T)
ncvar_put(cout,Assi_def,Assidiffarray3)
ncatt_put(cout,"lon","axis","X")
ncatt_put(cout,"lat","axis","Y")
nc_close(cout)
